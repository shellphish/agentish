{
  "nodes": [
    {
      "id": 1,
      "type": "asl/entry",
      "pos": [120, 280],
      "size": { "0": 140, "1": 26 },
      "flags": {},
      "order": 0,
      "mode": 0,
      "outputs": [
        {
          "name": "next",
          "type": "flow",
          "links": [1],
          "slot_index": 0
        }
      ],
      "properties": {
        "title": "Entry Node",
        "initial_state": {
          "alert_content": "str",
          "classification": "str",
          "investigation": "str",
          "response_action": "str"
        }
      },
      "color": "#334155",
      "bgcolor": "#1E293B"
    },
    {
      "id": 2,
      "type": "asl/llm",
      "pos": [340, 280],
      "size": { "0": 140, "1": 46 },
      "flags": {},
      "order": 1,
      "mode": 0,
      "inputs": [
        { "name": "in", "type": "flow", "link": 1 }
      ],
      "outputs": [
        {
          "name": "out",
          "type": "flow",
          "links": [2],
          "slot_index": 0
        }
      ],
      "title": "Classifier",
      "properties": {
        "title": "Classifier",
        "output_key": "llm_output",
        "input_state_keys": ["alert_content"],
        "output_state_keys": ["classification"],
        "system_prompt": "You are a security alert classifier. Classify the alert by category and severity.",
        "human_prompt": "Classify this alert: {alert_content}",
        "structured_output_enabled": false,
        "structured_output_schema": [],
        "selected_tools": [],
        "max_tool_iterations": 30,
        "iteration_warning_message": "You are close to the tool iteration limit. Wrap up soon without more tool calls."
      },
      "color": "#334155",
      "bgcolor": "#1E293B"
    },
    {
      "id": 3,
      "type": "asl/router",
      "pos": [560, 280],
      "size": { "0": 160, "1": 46 },
      "flags": {},
      "order": 2,
      "mode": 0,
      "inputs": [
        { "name": "in", "type": "flow", "link": 2 }
      ],
      "outputs": [
        {
          "name": "out",
          "type": "flow",
          "links": [3, 4, 5],
          "slot_index": 0
        }
      ],
      "title": "Category Router",
      "properties": {
        "title": "Category Router",
        "input_state_keys": ["classification"],
        "router_values": [
          { "node": "Malware Handler", "description": "Suspicious binaries, PE files, shellcode" },
          { "node": "Intrusion Handler", "description": "Unauthorized access, brute-force, lateral movement" },
          { "node": "Misconfiguration Handler", "description": "Open ports, weak credentials, policy violations" }
        ],
        "system_prompt": "Route the classified alert to the correct specialist handler based on category."
      },
      "color": "#334155",
      "bgcolor": "#1E293B"
    },
    {
      "id": 4,
      "type": "asl/llm",
      "pos": [820, 140],
      "size": { "0": 170, "1": 46 },
      "flags": {},
      "order": 3,
      "mode": 0,
      "inputs": [
        { "name": "in", "type": "flow", "link": 3 }
      ],
      "outputs": [
        {
          "name": "out",
          "type": "flow",
          "links": [6],
          "slot_index": 0
        }
      ],
      "title": "Malware Handler",
      "properties": {
        "title": "Malware Handler",
        "output_key": "llm_output",
        "input_state_keys": ["alert_content", "classification"],
        "output_state_keys": ["investigation"],
        "system_prompt": "Analyze malware alerts. Decompile suspicious binaries, check hashes.",
        "human_prompt": "Malware alert: {alert_content}\nClassification: {classification}",
        "structured_output_enabled": false,
        "structured_output_schema": [],
        "selected_tools": ["decompile", "check_hash", "run_sandbox"],
        "max_tool_iterations": 20,
        "iteration_warning_message": "You are close to the tool iteration limit. Wrap up soon without more tool calls."
      },
      "color": "#334155",
      "bgcolor": "#1E293B"
    },
    {
      "id": 5,
      "type": "asl/llm",
      "pos": [820, 280],
      "size": { "0": 170, "1": 46 },
      "flags": {},
      "order": 4,
      "mode": 0,
      "inputs": [
        { "name": "in", "type": "flow", "link": 4 }
      ],
      "outputs": [
        {
          "name": "out",
          "type": "flow",
          "links": [7],
          "slot_index": 0
        }
      ],
      "title": "Intrusion Handler",
      "properties": {
        "title": "Intrusion Handler",
        "output_key": "llm_output",
        "input_state_keys": ["alert_content", "classification"],
        "output_state_keys": ["investigation"],
        "system_prompt": "Investigate intrusion alerts. Check IPs, search logs for lateral movement.",
        "human_prompt": "Intrusion alert: {alert_content}\nClassification: {classification}",
        "structured_output_enabled": false,
        "structured_output_schema": [],
        "selected_tools": ["check_ip", "search_logs"],
        "max_tool_iterations": 15,
        "iteration_warning_message": "You are close to the tool iteration limit. Wrap up soon without more tool calls."
      },
      "color": "#334155",
      "bgcolor": "#1E293B"
    },
    {
      "id": 6,
      "type": "asl/llm",
      "pos": [820, 420],
      "size": { "0": 170, "1": 46 },
      "flags": {},
      "order": 5,
      "mode": 0,
      "inputs": [
        { "name": "in", "type": "flow", "link": 5 }
      ],
      "outputs": [
        {
          "name": "out",
          "type": "flow",
          "links": [8],
          "slot_index": 0
        }
      ],
      "title": "Misconfiguration Handler",
      "properties": {
        "title": "Misconfiguration Handler",
        "output_key": "llm_output",
        "input_state_keys": ["alert_content", "classification"],
        "output_state_keys": ["investigation"],
        "system_prompt": "Assess misconfigurations. Scan ports, review security policies.",
        "human_prompt": "Misconfiguration alert: {alert_content}\nClassification: {classification}",
        "structured_output_enabled": false,
        "structured_output_schema": [],
        "selected_tools": ["check_config", "scan_ports"],
        "max_tool_iterations": 10,
        "iteration_warning_message": "You are close to the tool iteration limit. Wrap up soon without more tool calls."
      },
      "color": "#334155",
      "bgcolor": "#1E293B"
    },
    {
      "id": 7,
      "type": "asl/llm",
      "pos": [1100, 280],
      "size": { "0": 140, "1": 86 },
      "flags": {},
      "order": 6,
      "mode": 0,
      "inputs": [
        { "name": "in", "type": "flow", "link": 6 },
        { "name": "in2", "type": "flow", "link": 7 },
        { "name": "in3", "type": "flow", "link": 8 }
      ],
      "outputs": [
        {
          "name": "out",
          "type": "flow",
          "links": null
        }
      ],
      "title": "Responder",
      "properties": {
        "title": "Responder",
        "output_key": "llm_output",
        "input_state_keys": ["investigation"],
        "output_state_keys": ["response_action"],
        "system_prompt": "Based on the investigation, take appropriate response action.",
        "human_prompt": "Investigation results: {investigation}\nTake action.",
        "structured_output_enabled": false,
        "structured_output_schema": [],
        "selected_tools": ["block_ip", "quarantine", "create_ticket"],
        "max_tool_iterations": 10,
        "iteration_warning_message": "You are close to the tool iteration limit. Wrap up soon without more tool calls."
      },
      "color": "#334155",
      "bgcolor": "#1E293B"
    }
  ],
  "links": [
    [1, 1, 0, 2, 0, "flow"],
    [2, 2, 0, 3, 0, "flow"],
    [3, 3, 0, 4, 0, "flow"],
    [4, 3, 0, 5, 0, "flow"],
    [5, 3, 0, 6, 0, "flow"],
    [6, 4, 0, 7, 0, "flow"],
    [7, 5, 0, 7, 1, "flow"],
    [8, 6, 0, 7, 2, "flow"]
  ],
  "groups": [],
  "config": {
    "state_schema": {
      "count": "int",
      "messages": "Annotated[List[BaseMessage], lambda x, y: x + y]",
      "alert_content": "str",
      "classification": "str",
      "investigation": "str",
      "response_action": "str"
    }
  }
}
