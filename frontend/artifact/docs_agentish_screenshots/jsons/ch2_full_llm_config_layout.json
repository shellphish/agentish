{
  "nodes": [
    {
      "id": 1,
      "type": "asl/entry",
      "pos": [200, 200],
      "size": { "0": 140, "1": 26 },
      "flags": {},
      "order": 0,
      "mode": 0,
      "outputs": [
        {
          "name": "next",
          "type": "flow",
          "links": [1],
          "slot_index": 0
        }
      ],
      "properties": {
        "title": "Entry Node",
        "initial_state": {
          "alert_content": "str",
          "classification": "str"
        }
      },
      "color": "#334155",
      "bgcolor": "#1E293B"
    },
    {
      "id": 2,
      "type": "asl/llm",
      "pos": [450, 200],
      "size": { "0": 140, "1": 46 },
      "flags": {},
      "order": 1,
      "mode": 0,
      "inputs": [
        { "name": "in", "type": "flow", "link": 1 }
      ],
      "outputs": [
        {
          "name": "out",
          "type": "flow",
          "links": null
        }
      ],
      "title": "Alert Classifier",
      "properties": {
        "title": "Alert Classifier",
        "output_key": "llm_output",
        "input_state_keys": ["alert_content"],
        "output_state_keys": ["classification"],
        "system_prompt": "You are a security alert triage specialist at a SOC. You have deep expertise in network security, malware analysis, and incident classification.\n\nFor each alert, produce:\n1. Severity: critical / high / medium / low / informational\n2. Category: malware, intrusion, data-exfiltration, misconfiguration, false-positive\n3. Confidence: 0.0 to 1.0\n\nIf confidence < 0.7, classify severity as 'high' and explain why.\nNever classify as 'informational' unless confidence > 0.9.",
        "human_prompt": "Classify this alert: {alert_content}",
        "structured_output_enabled": true,
        "structured_output_schema": [
          {
            "name": "severity",
            "type": "str",
            "description": "Alert severity: critical, high, medium, low, or informational"
          },
          {
            "name": "category",
            "type": "str",
            "description": "Alert category: malware, intrusion, data-exfiltration, misconfiguration, or false-positive"
          },
          {
            "name": "confidence",
            "type": "float",
            "description": "Classification confidence from 0.0 to 1.0"
          },
          {
            "name": "reasoning",
            "type": "str",
            "description": "2-3 sentences explaining the classification decision"
          }
        ],
        "selected_tools": ["check_ip", "check_domain"],
        "max_tool_iterations": 10,
        "iteration_warning_message": "Wrap up your analysis. Provide your final classification without further tool calls."
      },
      "color": "#334155",
      "bgcolor": "#1E293B"
    }
  ],
  "links": [
    [1, 1, 0, 2, 0, "flow"]
  ],
  "groups": [],
  "config": {
    "state_schema": {
      "count": "int",
      "messages": "Annotated[List[BaseMessage], lambda x, y: x + y]",
      "alert_content": "str",
      "classification": "str"
    }
  }
}
